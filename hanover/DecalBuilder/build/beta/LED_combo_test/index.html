<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image generator V1</title>
</head>
<body> 
    <link rel="stylesheet" href="index.css">
    <div>
        <p class="title">TESTING CENTRE</p>
        <div class="note">
            <img class="noteimg" src="/files/images/wip.jpg">
            <p>Only does main display for now, working on side and read disp.             ‚ö†</p>
            <p>‚ö† this thing should fit on the main display of scada's han0v3r             ‚ö†</p>
        </div>
    </div>
    <hr>
    <br>
    <div class="info">
        <p>Your image will render here, right click to save.</p>
    </div>
    <canvas id='textCanvasMAIN' height=140px></canvas>
    <img id='imageMAIN'></img>
    <br>
    <canvas id='textCanvasSIDE' height=140px></canvas>
    <img id='imageSIDE'></img>

    <hr>
    <br>

    <uinputMain id="userinput">
        <uinput>
            <p>Main Text</p>
            <input type="color" id="MTkleur" value="#FF9933">
            <input type="text" id="text">
        </uinput>

        <uinput>
            <p>Bottom Textüçë</p>
            <input type="color" id="BTkleur" value="#FF9933">
            <input type="text" id="bottomtext">
        </uinput>

        <uinput>
            <p>route number</p>
            <input type="color" id="RNkleur" value="#FF9933">
            <input type="text" id="routenummer">
        </uinput>
    </uinputMain>

    <p>
        Planned updates: Fixing the side display
    </p>
    <p>
        Fix log:
        <p>Color selector is now availible</p>
        <p>image renderer should now work a bit better</p>
        <p>i think thats all i did for now</p>
    </p>
    <hr>
    <debug id='debugmain'>DEBUG for MAIN</debug> -
    <debug id='debugsub'>DEBUG for SUB</debug> -
    <debug id='debugnum'>DEBUG for NUM</debug>


    <!-- Render the MAIN display -->
    <script>
        var tCtxMAIN = document.getElementById('textCanvasMAIN').getContext('2d'), //Hidden canvas
        imageElemMAIN = document.getElementById('imageMAIN'); //Image element
        var maintext = document.getElementById('text');
        var bottomtext = document.getElementById('bottomtext');
        var routenummer = document.getElementById('routenummer');
        var mainkleur = document.getElementById('MTkleur');
        var bottomkleur = document.getElementById('BTkleur')
        var routekleur = document.getElementById('RNkleur')

        // Text input element
        document.getElementById('userinput').addEventListener('keyup', function() {
    
            /*-- size canvas --*/       
            tCtxMAIN.canvas.width = 870.8

            //    1 OP 6.22 IS DE ASPECT RATIO xxjes 
            //     breed= 870,8 & hoog 140

            //CHARACTER WIDTH AT 10 PX is 1 SO 10:1

            var rnLen = tCtxMAIN.measureText(routenummer.value).width
            var terugnaarlinks = (870-(rnLen*14)-10);
      
            //black background//
            tCtxMAIN.fillStyle = "#000000";
            tCtxMAIN.fillRect(0, 0, tCtxMAIN.canvas.width, tCtxMAIN.canvas.height);

            //text//
            tCtxMAIN.fillStyle = mainkleur.value;       //ignore these lol, dont think they do anything.. kinda forgot lol
            tCtxMAIN.font = "80px MONOled";             //max width 430  height 100
            tCtxMAIN.fillText(maintext.value, 10, 60);
            
            tCtxMAIN.fillStyle = bottomkleur.value;
            tCtxMAIN.font = "40px MONOled";             //max width 430  height 40
            tCtxMAIN.fillText(bottomtext.value, 10, 120);

            tCtxMAIN.fillStyle = routekleur.value;
            tCtxMAIN.font = "140px MONOled";            //max width 160    height 160
            tCtxMAIN.fillText(routenummer.value, terugnaarlinks, 110);

            //debug//
            var debugmain = document.getElementById('debugmain')
            debugmain.textContent = text.value.length

            var debugsub = document.getElementById('debugsub')
            debugsub.textContent = bottomtext.value.length

            var debugnum = document.getElementById('debugnum')
            debugnum.textContent =  rnLen

            //send data to client//
            imageElemMAIN.src = tCtxMAIN.canvas.toDataURL();
            console.log(imageElemMAIN.src);
        }, false);
    </script>





    <!-- Render the SIDE display -->
    <script>
        var tCtxSIDE = document.getElementById('textCanvasSIDE').getContext('2d'), //Hidden canvas
        imageElemSIDE = document.getElementById('imageSIDE'); //Image element
        var maintext = document.getElementById('text');
        var bottomtext = document.getElementById('bottomtext');
        var routenummer = document.getElementById('routenummer');
        var mainkleur = document.getElementById('MTkleur');
        var bottomkleur = document.getElementById('BTkleur')
        var routekleur = document.getElementById('RNkleur')

        // Text input element
        document.getElementById('userinput').addEventListener('keyup', function() {
    
            /*-- size canvas --*/       
            tCtxSIDE.canvas.width = 1000

            //    1 OP 6.22 IS DE ASPECT RATIO xxjes 
            //     breed= 870,8 & hoog 140

            //CHARACTER WIDTH AT 10 PX is 1 SO 10:1

            var rnLen = tCtxSIDE.measureText(routenummer.value).width
            var terugnaarlinks = (1000-(rnLen*14)-10);

            
            var rout = tCtxSIDE.measureText(routenummer.value).width
            var weghier = ((rout*14)+10)
      
            //black background//
            tCtxSIDE.fillStyle = "#000000";
            tCtxSIDE.fillRect(0, 0, tCtxSIDE.canvas.width, tCtxSIDE.canvas.height);

            //text//
            tCtxSIDE.fillStyle = mainkleur.value;       //ignore these lol, dont think they do anything.. kinda forgot lol
            tCtxSIDE.font = "140px MONOled";             //max width 430  height 100
            tCtxSIDE.fillText(maintext.value, weghier, 110);
            
           

            tCtxSIDE.fillStyle = routekleur.value;
            tCtxSIDE.font = "140px MONOled";            //max width 160    height 160
            tCtxSIDE.fillText(routenummer.value, 10, 110);

            //debug//
            var debugmain = document.getElementById('debugmain')
            debugmain.textContent = text.value.length

            var debugsub = document.getElementById('debugsub')
            debugsub.textContent = bottomtext.value.length

            var debugnum = document.getElementById('debugnum')
            debugnum.textContent =  rnLen

            //send data to client//
            imageElemSIDE.src = tCtxSIDE.canvas.toDataURL();
            console.log(imageElemSIDE.src);
        }, false);
    </script>

    

</body>
</html>